<!DOCTYPE html>
<html data-n-head="lang" data-n-head-ssr lang="ja">
  <head>
    <meta data-hid="charset" data-n-head="true" charset="utf-8"><meta data-hid="viewport" data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-hid="mobile-web-app-capable" data-n-head="true" content="yes" name="mobile-web-app-capable"><meta data-hid="apple-mobile-web-app-title" data-n-head="true" content="macoshita" name="apple-mobile-web-app-title"><meta data-hid="author" data-n-head="true" content="macoshita" name="author"><meta data-hid="description" data-n-head="true" content="macoshita website" name="description"><meta data-hid="theme-color" data-n-head="true" content="black" name="theme-color"><meta data-hid="og:type" data-n-head="true" content="website" name="og:type" property="og:type"><meta data-hid="og:title" data-n-head="true" content="macoshita" name="og:title" property="og:title"><meta data-hid="og:description" data-n-head="true" content="macoshita website" name="og:description" property="og:description"><title data-n-head="true">オレオレ webpack loader 作って nuxt に導入するメモ - macoshita</title><link href="/_nuxt/manifest.25346d8c.json" rel="manifest" data-n-head="true"><link href="/_nuxt/icons/icon_64.bI0U370z8U0.png" rel="shortcut icon" data-n-head="true"><link href="/_nuxt/icons/icon_512.bI0U370z8U0.png" rel="apple-touch-icon" data-n-head="true" sizes="512x512"><script src="//www.googletagmanager.com/gtm.js?id=GTM-WX4VWRQ&l=dataLayer" async data-n-head="true"></script><link href="/_nuxt/manifest.71412949d7899dded1b3.js" rel="preload" as="script"><link href="/_nuxt/vendor.0d4f966fe985ae7a164f.js" rel="preload" as="script"><link href="/_nuxt/app.6b37b7f4988e1a4a1932.js" rel="preload" as="script"><link href="/_nuxt/layouts/default.4e64ec53dc4da6966f1f.js" rel="preload" as="script"><link href="/_nuxt/pages/blog/_slug.48281ca73f7dbd1eb22b.js" rel="preload" as="script"><link href="/_nuxt/pages/index.3cc03a96935e1bc13b46.js" rel="prefetch"><link href="/_nuxt/5.e028b903f24b3e563373.js" rel="prefetch"><link href="/_nuxt/6.86d4155bac657cb76009.js" rel="prefetch"><link href="/_nuxt/7.83e92dcb1c55c15e6678.js" rel="prefetch"><link href="/_nuxt/8.7d63c71dcb0129837c93.js" rel="prefetch"><link href="/_nuxt/9.791767a21813452251af.js" rel="prefetch"><link href="/_nuxt/10.0c39347437c338b7df6a.js" rel="prefetch"><link href="/_nuxt/11.c20c5ba922ac2bcf4651.js" rel="prefetch"><style data-vue-ssr-id="42d9995c:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style><style data-vue-ssr-id="3f8dfcec:0">body,html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Droid Sans,Helvetica Neue,sans-serif}</style><style data-vue-ssr-id="9c1404d0:0">code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><style data-vue-ssr-id="31f65077:0">._9g5wqN7qORABTQlpycLRy_1 img{max-width:100%}</style>
  </head>
  <body data-n-head="">
    <div id="__nuxt" data-server-rendered="true"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#000;opacity:0"></div><div id="__layout"><div class="container"><header><h1><a href="/" class="nuxt-link-active">macoshita</a></h1></header><main><article><header><h2>オレオレ webpack loader 作って nuxt に導入するメモ</h2><time>2018-03-16</time></header><div class="_9g5wqN7qORABTQlpycLRy_1"><p>このブログを作るのにちょっとした webpack loader を書いて nuxt に適用したので、そのメモ。</p>
<h2>メモ</h2>
<ul>
<li><a href="https://webpack.js.org/contribute/writing-a-loader/">基本の書き方</a></li>
<li>node で動かすことに留意する
<ul>
<li>import/export で書かれてるが、 node でv9 でもまだ <code>--experimental-modules</code> 立てないと動かないので、 <code>module.exports</code> と <code>require</code> で書く等。</li>
</ul>
</li>
<li>雛形を作成して、読み込まれることを確認してから先に進む
<ul>
<li>単に source を受け取って console.log するだけのやつでもいい</li>
</ul>
</li>
<li>loader は hot reload 対象外
<ul>
<li>当たり前だけど。 nuxt 起動し直しが必要</li>
</ul>
</li>
</ul>
<h2>nuxt.config.js</h2>
<p><a href="https://nuxtjs.org/api/configuration-build/#extend">build - extend</a> で webpack の設定を拡張してやる必要がある。</p>
<p>オレオレ hoge-loader を loaders において、下記のような設定を書く</p>
<pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  build<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">extend</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      config<span class="token punctuation">.</span>resolveLoader<span class="token punctuation">.</span>modules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'loaders'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>あとは利用側で <code>import fuga from 'hoge-loader!fuga.js'</code> という形で利用できる。</p>
<hr>
<p>メンテされてない loader 使うくらいならサクッと作ったほうがいい説ある。<br>
ってそれ gulp でも通った道や……。</p>
</div></article></main></div></div></div><script type="text/javascript">window.__NUXT__={layout:"default",data:[{slug:"2018-03-16-webpack-loader",date:"2018-03-16",title:"オレオレ webpack loader 作って nuxt に導入するメモ",content:'<p>このブログを作るのにちょっとした webpack loader を書いて nuxt に適用したので、そのメモ。</p>\n<h2>メモ</h2>\n<ul>\n<li><a href="https://webpack.js.org/contribute/writing-a-loader/">基本の書き方</a></li>\n<li>node で動かすことに留意する\n<ul>\n<li>import/export で書かれてるが、 node でv9 でもまだ <code>--experimental-modules</code> 立てないと動かないので、 <code>module.exports</code> と <code>require</code> で書く等。</li>\n</ul>\n</li>\n<li>雛形を作成して、読み込まれることを確認してから先に進む\n<ul>\n<li>単に source を受け取って console.log するだけのやつでもいい</li>\n</ul>\n</li>\n<li>loader は hot reload 対象外\n<ul>\n<li>当たり前だけど。 nuxt 起動し直しが必要</li>\n</ul>\n</li>\n</ul>\n<h2>nuxt.config.js</h2>\n<p><a href="https://nuxtjs.org/api/configuration-build/#extend">build - extend</a> で webpack の設定を拡張してやる必要がある。</p>\n<p>オレオレ hoge-loader を loaders において、下記のような設定を書く</p>\n<pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  build<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token function">extend</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      config<span class="token punctuation">.</span>resolveLoader<span class="token punctuation">.</span>modules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'loaders\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n<p>あとは利用側で <code>import fuga from \'hoge-loader!fuga.js\'</code> という形で利用できる。</p>\n<hr>\n<p>メンテされてない loader 使うくらいならサクッと作ったほうがいい説ある。<br>\nってそれ gulp でも通った道や……。</p>\n'}],error:null,serverRendered:!0}</script><script src="/_nuxt/manifest.71412949d7899dded1b3.js" defer></script><script src="/_nuxt/layouts/default.4e64ec53dc4da6966f1f.js" defer></script><script src="/_nuxt/pages/blog/_slug.48281ca73f7dbd1eb22b.js" defer></script><script src="/_nuxt/vendor.0d4f966fe985ae7a164f.js" defer></script><script src="/_nuxt/app.6b37b7f4988e1a4a1932.js" defer></script>
  

